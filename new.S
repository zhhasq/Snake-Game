#include <p32xxxx.h>
.global main,line3,center,LR,line1,line2,gametime,gametime2
.text
.set noreorder 
LR:
.short  0x1B,0x5B,0x33,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x34,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x35,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x36,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x37,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x38,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x39,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x31,0x30,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x31,0x31,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x31,0x32,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x31,0x33,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x31,0x34,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x31,0x35,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x31,0x36,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x31,0x37,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x31,0x38,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x31,0x39,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x32,0x30,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x32,0x31,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x32,0x32,0x3B,0x33,0x48,0x58
.short  0x1B,0x5B,0x33,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x34,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x35,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x36,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x37,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x38,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x39,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x31,0x30,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x31,0x31,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x31,0x32,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x31,0x33,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x31,0x34,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x31,0x35,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x31,0x36,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x31,0x37,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x31,0x38,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x31,0x39,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x32,0x30,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x32,0x31,0x3B,0x37,0x38,0x48,0x58
.short  0x1B,0x5B,0x32,0x32,0x3B,0x37,0x38,0x48,0x58
line1:
.short 0x1B,0x5B,0x33,0x3B,0x33,0x48,0x58
line2:
.short 0x1B,0x5B,0x32,0x32,0x3B,0x33,0x48
line3:
.short 0x1B,0x5B,0x32,0x34,0x3B,0x37,0x32,0x48   #global time  #change 3,4
center:
.short 0x1B,0x5B,0x31,0x32,0x3B,0x34,0x30,0x48
gametime:
.short 0x1B,0x5B,0x32,0x33,0x3B,0x36,0x38,0x48
gametime2:
.short 0x1B,0x5B,0x32,0x33,0x3B,0x37,0x33,0x48
.ent main
main:
nop
bal initialize 
nop
nop
nop
	check:
 	lw k1,U2STA
	andi k1, k1, 0x00000001
	beq k1,0,check
	nop
	nop
	lb k0,U2RXREG
	sb k0,0(s0)
	nop
	sw k0,U2TXREG
	addi s0,s0,4
	addi t0,t0,-1
	li t1,2000
	bne t0,0,check
	nop
	nop
	nop
bal interrupt
nop
nop
nop
haha:
nop
lw v0,PORTA
beq v0,0xC6BF,RA7
nop
beq v0,0xC67F,RA6
nop
li v0,0XFFFFFFFF
sw v0,PORTB
sw v0,PORTE
b haha
nop
RA7:
li s6,0x63
sw s6,0xA0000240
li s6,0x0200		#clear U2RXIF
sw s6,IFS1SET
b haha
nop
nop
RA6:
li s6,0x8000		#turn off timer 1
sw s6,T1CONCLR
nop
b haha
nop
nop
interrupt:
li k0,0x00001000
sw k0,INTCON
sw zero,IFS0		#clear IFS0
sw zero,IFS1		#clear IFS1
sw zero,IEC0			#clear  IEC0
sw zero,IEC1			#clear IEC1
nop
li k0,0x00011010
sw k0,IEC0			 #set T1IE and T3IE and T4IE and U1RXIE
li k0,0x0200		 #set U2RXIE
sw k0,IEC1
nop
li k0,0x0000001A
sw k0,IPC8			#Set UART2 interrupt with 6 priority and 2 sub-priority 
nop
li k0,0x00000019
sw k0,IPC1          #Set TIMRE1 interrupt with 6 priority and 1 sub-priority
nop
li k0,0x00000018
sw k0,IPC3          #Set TIMRE3(realtime) interrupt with 6 priority and 0 sub-priority
sw k0,IPC4
nop
li k0,0x9FC01000			#initialize EBASE with value of 0x9FC01000
mtc0 k0,$15,1
li k0,0x20		 	#initialize INTCTL with value of 0x20 (vector length 32 bits)
mtc0 k0,$12,1
	
sw zero, T1CON					#turn off timer 1
sw zero, T4CON					#turn off timer 4
nop 
li k0, 0x00000030				#set timer1 prescalers to 1:256
sw k0, T1CONSET   
li k0, 0x00000070
sw k0, T4CONSET
nop 			
sw zero, TMR1				 #clear TMR1
sw zero,TMR4
nop
sw zero, PR1    			#clear PR1
sw zero,PR4
nop
li k0, 39060		#initializePR1 with value of 39060( 1seconds)
sw k0, PR1
nop
li k0,39060
sw k0,PR4
nop
sw zero,T2CON		#turn off timer 2
sw zero,T3CON		#turn off timer 3
nop
li k0,0x00000078    #Enable 32-bit mode of timer2 and timer 3. prescaler at 1:256
sw k0,T2CONSET
sw zero,TMR2		#clear TMR2
sw zero,PR2			#clear PR2
nop
li k0,2344000        #2344000
sw k0,PR2			#set PR2 with 60seconds 
nop
li k0, 0x8000              
sw k0,T2CONSET      #turn on timer2
nop
EI				    #enable interrupt
nop
nop
jr ra
nop
nop
.end main
# s0 is for real time
#t1 for delay 
#t0 running time